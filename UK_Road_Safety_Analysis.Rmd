
title: "UK Road Traffic Accident Analysis (2024)"
subtitle: "Exploration, Preparation, and Risk Factor Analysis"
author: "Tiago De Oliveira Freitas - 2021406"
date: "November 30, 2025"
output: 
  html_document
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: cosmo
    highlight: tango
    code_folding: show
    df_print: paged

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      fig.width = 10, fig.height = 6, dpi = 150)
```
# 1. Introduction and Project Goal {.tabset}

## 1.1. Context

This project conducts a comprehensive exploratory analysis of road traffic accident data in the United Kingdom for the year 2024, utilizing public data from the **UK Department for Transport**.

## 1.2. Research Question

**What factors are most correlated with severe traffic accidents?**

This question is fundamental for:

- Identifying key risk factors
- Informing public road safety policies
- Reducing serious accidents and fatalities

## 1.3. Methodology

The project follows these steps:

1.  **Initial Exploration**: Load and understand the data structure.
2.  **Cleaning and Preparation**: Handle missing values and create new features.
3.  **Exploratory Data Analysis (EDA)**: Visualize relationships and patterns.
4.  **Encoding and PCA**: Prepare data for modeling and reduce dimensionality.
5.  **Conclusion**: Present findings and their implications.

---

# 2. Loading Libraries and Data

## 2.1. Installing and Loading Packages

```{r libraries}
# Install and load necessary packages
required_packages <- c("tidyverse", "ggplot2", "corrplot", "psych", 
                       "gridExtra", "scales", "RColorBrewer", 
                       "FactoMineR", "factoextra", "knitr", "kableExtra")

for(pkg in required_packages) {
  if(!require(pkg, character.only = TRUE, quietly = TRUE)) {
    install.packages(pkg, repos = "https://cloud.r-project.org/", quiet = TRUE)
    library(pkg, character.only = TRUE)
  }
}

cat("All packages loaded successfully!\n")
```

## 2.5. Descriptive Statistics

```{r summary_stats}
# Statistical summary
summary(df) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

# 3. Severity Distribution Analysis

## 3.1. Severity Classification

Accidents are classified into three levels:

-   **Fatal (1)**: Accidents resulting in deaths.
-   **Serious (2)**: Accidents with serious injuries.
-   **Slight (3)**: Accidents with minor injuries.

```{r severity_distribution}
# Create severity labels
df$severity_label <- factor(df$collision_severity, 
                             levels = c(1, 2, 3),
                             labels = c("Fatal", "Serious", "Slight"))

# Calculate distribution
severity_dist <- table(df$severity_label)
severity_pct <- prop.table(severity_dist) * 100

# Display table
severity_table <- data.frame(
  Severity = names(severity_dist),
  Count = as.numeric(severity_dist),
  Percentage = sprintf("%.2f%%", severity_pct)
)

severity_table %>%
  kable(col.names = c("Severity", "Count", "Percentage (%)")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 3.2. Distribution Visualization

```{r severity_plot, fig.cap="Accident Severity Distribution"}
severity_df <- data.frame(
  severity = names(severity_dist),
  count = as.numeric(severity_dist),
  pct = as.numeric(severity_pct)
)

ggplot(severity_df, aes(x=severity, y=count, fill=severity)) +
  geom_bar(stat="identity", color="black", size=1) +
  scale_fill_manual(values=c("Fatal"="#d62728", "Serious"="#ff7f0e", "Slight"="#2ca02c")) +
  geom_text(aes(label=sprintf("%s\n(%.1f%%)", 
                              format(count, big.mark=","), pct)),
            vjust=-0.5, size=4, fontface="bold") +
  labs(title="Accident Severity Distribution",
       x="Severity Level",
       y="Number of Accidents") +
  theme_minimal() +
  theme(plot.title = element_text(size=16, face="bold", hjust=0.5),
        axis.title = element_text(size=12),
        axis.text = element_text(size=11),
        legend.position = "none") +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.1)))
```

**Observation**: The majority of accidents (81.14%) are classified as slight, while fatal accidents represent only 0.66% of the total.


# 4. Correlation Analysis

## 4.1. Correlation Matrix

```{r correlation_matrix}
# Select numerical columns
numerical_cols <- c("collision_severity", "number_of_vehicles", "number_of_casualties",
                    "speed_limit", "urban_or_rural_area", "is_severe", "light_conditions",
                    "weather_conditions", "road_surface_conditions")

# Calculate correlation matrix
corr_data <- df[, numerical_cols]
corr_matrix <- cor(corr_data, use="complete.obs")

# Visualize
corrplot(corr_matrix, method="color", type="upper", 
         addCoef.col="black", number.cex=0.7,
         tl.col="black", tl.srt=45, tl.cex=0.9,
         col=colorRampPalette(c("#2ca02c", "white", "#d62728"))(200),
         title="Correlation Matrix",
         mar=c(0,0,2,0))
```

## 4.2. Top 10 Correlations with Severe Accidents

```{r top_correlations}
# Extract correlations with is_severe
severity_corr <- corr_matrix[, "is_severe"]
severity_corr <- sort(severity_corr[names(severity_corr) != "is_severe"], decreasing=TRUE)

# Display table
top_corr_table <- data.frame(
  Feature = names(head(severity_corr, 10)),
  Correlation = sprintf("%.4f", head(severity_corr, 10))
)

top_corr_table %>%
  kable(col.names = c("Variable", "Correlation Coefficient")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 4.3. Correlation Visualization

```{r correlation_plot, fig.cap="Top 10 Features Correlated with Severe Accidents"}
top_corr_df <- data.frame(
  feature = names(head(severity_corr, 10)),
  correlation = as.numeric(head(severity_corr, 10))
)
top_corr_df$feature <- factor(top_corr_df$feature, 
                               levels=top_corr_df$feature[order(top_corr_df$correlation)])

ggplot(top_corr_df, aes(x=correlation, y=feature, fill=correlation>0)) +
  geom_bar(stat="identity", color="black") +
  scale_fill_manual(values=c("TRUE"="#d62728", "FALSE"="#2ca02c")) +
  geom_vline(xintercept=0, color="black", size=0.8) +
  labs(title="Top 10 Features Correlated with Severe Accidents",
       x="Correlation Coefficient",
       y="Variable") +
  theme_minimal() +
  theme(plot.title = element_text(size=16, face="bold", hjust=0.5),
        axis.title = element_text(size=12),
        axis.text = element_text(size=11),
        legend.position = "none")
```
