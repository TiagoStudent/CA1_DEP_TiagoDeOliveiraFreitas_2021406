
## title: 
  "UK Road Traffic Accident Analysis (2024)"
## subtitle: 
  "Exploration, Preparation, and Risk Factor Analysis"
## author: 
  "Tiago De Oliveira Freitas - 2021406"
## date: 
  "November 30, 2025"
output: 
  html_document
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: cosmo
    highlight: tango
    code_folding: show
    df_print: paged

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      fig.width = 10, fig.height = 6, dpi = 150)
```
# 1. Introduction and Project Goal {.tabset}

## 1.1. Context

This project conducts a comprehensive exploratory analysis of road traffic accident data in the United Kingdom for the year 2024, utilizing public data from the **UK Department for Transport**.

## 1.2. Research Question

**What factors are most correlated with severe traffic accidents?**

This question is fundamental for:

- Identifying key risk factors
- Informing public road safety policies
- Reducing serious accidents and fatalities

## 1.3. Methodology

The project follows these steps:

1.  **Initial Exploration**: Load and understand the data structure.
2.  **Cleaning and Preparation**: Handle missing values and create new features.
3.  **Exploratory Data Analysis (EDA)**: Visualize relationships and patterns.
4.  **Encoding and PCA**: Prepare data for modeling and reduce dimensionality.
5.  **Conclusion**: Present findings and their implications.

---

# 2. Loading Libraries and Data

## 2.1. Installing and Loading Packages

```{r libraries}
# Install and load necessary packages
required_packages <- c("tidyverse", "ggplot2", "corrplot", "psych", 
                       "gridExtra", "scales", "RColorBrewer", 
                       "FactoMineR", "factoextra", "knitr", "kableExtra")

for(pkg in required_packages) {
  if(!require(pkg, character.only = TRUE, quietly = TRUE)) {
    install.packages(pkg, repos = "https://cloud.r-project.org/", quiet = TRUE)
    library(pkg, character.only = TRUE)
  }
}

cat("All packages loaded successfully!\n")
```

## 2.5. Descriptive Statistics

```{r summary_stats}
# Statistical summary
summary(df) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

# 3. Severity Distribution Analysis

## 3.1. Severity Classification

Accidents are classified into three levels:

-   **Fatal (1)**: Accidents resulting in deaths.
-   **Serious (2)**: Accidents with serious injuries.
-   **Slight (3)**: Accidents with minor injuries.

```{r severity_distribution}
# Create severity labels
df$severity_label <- factor(df$collision_severity, 
                             levels = c(1, 2, 3),
                             labels = c("Fatal", "Serious", "Slight"))

# Calculate distribution
severity_dist <- table(df$severity_label)
severity_pct <- prop.table(severity_dist) * 100

# Display table
severity_table <- data.frame(
  Severity = names(severity_dist),
  Count = as.numeric(severity_dist),
  Percentage = sprintf("%.2f%%", severity_pct)
)

severity_table %>%
  kable(col.names = c("Severity", "Count", "Percentage (%)")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 3.2. Distribution Visualization

```{r severity_plot, fig.cap="Accident Severity Distribution"}
severity_df <- data.frame(
  severity = names(severity_dist),
  count = as.numeric(severity_dist),
  pct = as.numeric(severity_pct)
)

ggplot(severity_df, aes(x=severity, y=count, fill=severity)) +
  geom_bar(stat="identity", color="black", size=1) +
  scale_fill_manual(values=c("Fatal"="#d62728", "Serious"="#ff7f0e", "Slight"="#2ca02c")) +
  geom_text(aes(label=sprintf("%s\n(%.1f%%)", 
                              format(count, big.mark=","), pct)),
            vjust=-0.5, size=4, fontface="bold") +
  labs(title="Accident Severity Distribution",
       x="Severity Level",
       y="Number of Accidents") +
  theme_minimal() +
  theme(plot.title = element_text(size=16, face="bold", hjust=0.5),
        axis.title = element_text(size=12),
        axis.text = element_text(size=11),
        legend.position = "none") +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.1)))
```

**Observation**: The majority of accidents (81.14%) are classified as slight, while fatal accidents represent only 0.66% of the total.


# 4. Correlation Analysis

## 4.1. Correlation Matrix

```{r correlation_matrix}
# Select numerical columns
numerical_cols <- c("collision_severity", "number_of_vehicles", "number_of_casualties",
                    "speed_limit", "urban_or_rural_area", "is_severe", "light_conditions",
                    "weather_conditions", "road_surface_conditions")

# Calculate correlation matrix
corr_data <- df[, numerical_cols]
corr_matrix <- cor(corr_data, use="complete.obs")

# Visualize
corrplot(corr_matrix, method="color", type="upper", 
         addCoef.col="black", number.cex=0.7,
         tl.col="black", tl.srt=45, tl.cex=0.9,
         col=colorRampPalette(c("#2ca02c", "white", "#d62728"))(200),
         title="Correlation Matrix",
         mar=c(0,0,2,0))
```

## 4.2. Top 10 Correlations with Severe Accidents

```{r top_correlations}
# Extract correlations with is_severe
severity_corr <- corr_matrix[, "is_severe"]
severity_corr <- sort(severity_corr[names(severity_corr) != "is_severe"], decreasing=TRUE)

# Display table
top_corr_table <- data.frame(
  Feature = names(head(severity_corr, 10)),
  Correlation = sprintf("%.4f", head(severity_corr, 10))
)

top_corr_table %>%
  kable(col.names = c("Variable", "Correlation Coefficient")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 4.3. Correlation Visualization

```{r correlation_plot, fig.cap="Top 10 Features Correlated with Severe Accidents"}
top_corr_df <- data.frame(
  feature = names(head(severity_corr, 10)),
  correlation = as.numeric(head(severity_corr, 10))
)
top_corr_df$feature <- factor(top_corr_df$feature, 
                               levels=top_corr_df$feature[order(top_corr_df$correlation)])

ggplot(top_corr_df, aes(x=correlation, y=feature, fill=correlation>0)) +
  geom_bar(stat="identity", color="black") +
  scale_fill_manual(values=c("TRUE"="#d62728", "FALSE"="#2ca02c")) +
  geom_vline(xintercept=0, color="black", size=0.8) +
  labs(title="Top 10 Features Correlated with Severe Accidents",
       x="Correlation Coefficient",
       y="Variable") +
  theme_minimal() +
  theme(plot.title = element_text(size=16, face="bold", hjust=0.5),
        axis.title = element_text(size=12),
        axis.text = element_text(size=11),
        legend.position = "none")
```

**Interpretation**:

-   **Positive Correlations**: Rural areas (+0.047) and high speed limits (+0.041) increase severity.
-   **Negative Correlations**: Road surface conditions (-0.055) and weather conditions (-0.041) have an inverse relationship.


# 5. Bivariate Analysis: Urban vs. Rural

## 5.1. Comparison of Severe Accident Rates

```{r urban_rural_analysis}
# Create labels
df$area_label <- factor(df$urban_or_rural_area,
                        levels = c(1, 2),
                        labels = c("Urban", "Rural"))

# Calculate rates
urban_rural_table <- table(df$area_label, df$is_severe)
urban_rural_pct <- prop.table(urban_rural_table, margin=1) * 100

# Display table
urban_rural_df_table <- data.frame(
  Area = rownames(urban_rural_pct),
  Slight = sprintf("%.2f%%", urban_rural_pct[, 1]),
  Severe = sprintf("%.2f%%", urban_rural_pct[, 2])
)

urban_rural_df_table %>%
  kable(col.names = c("Area Type", "Slight Accidents (%)", "Severe Accidents (%)")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 5.2. Urban vs. Rural Visualization

```{r urban_rural_plot, fig.cap="Severe Accident Rate: Urban vs. Rural"}
urban_rural_df <- as.data.frame(urban_rural_pct)
colnames(urban_rural_df) <- c("area", "severity", "percentage")
urban_rural_df$severity <- factor(urban_rural_df$severity,
                                  levels = c(0, 1),
                                  labels = c("Slight", "Severe"))

ggplot(urban_rural_df, aes(x=area, y=percentage, fill=severity)) +
  geom_bar(stat="identity", position="dodge", color="black") +
  scale_fill_manual(values=c("Slight"="#2ca02c", "Severe"="#d62728")) +
  labs(title="Severe Accident Rate: Urban vs. Rural",
       x="Area Type",
       y="Percentage (%)",
       fill="Severity") +
  theme_minimal() +
  theme(plot.title = element_text(size=16, face="bold", hjust=0.5),
        axis.title = element_text(size=12),
        axis.text = element_text(size=11),
        legend.position = "top")
```

**Key Finding**: Rural areas have a **23.67%** rate of severe accidents, while urban areas have a **17.43%** rate.

# 6. Principal Component Analysis (PCA)

## 6.1. Data Preparation

```{r pca_preparation}
# Select features for PCA
pca_features <- c("number_of_vehicles", "number_of_casualties", "speed_limit",
                  "urban_or_rural_area", "light_conditions", "weather_conditions",
                  "road_surface_conditions", "junction_detail", "junction_control")

# Prepare data
pca_data <- df[complete.cases(df[, pca_features]), pca_features]

cat(sprintf("Data for PCA: %s rows × %s columns\n", 
            format(nrow(pca_data), big.mark=","), ncol(pca_data)))

# Standardize
pca_scaled <- scale(pca_data)
cat(sprintf("Mean after standardization: %.6f\n", mean(pca_scaled)))
cat(sprintf("Standard deviation after standardization: %.6f\n", sd(pca_scaled)))
```

## 6.2. Applying PCA

```{r pca_application}
# Apply PCA
pca_result <- prcomp(pca_scaled, center=FALSE, scale.=FALSE)

# Calculate explained variance
explained_var <- (pca_result$sdev^2) / sum(pca_result$sdev^2)
cumulative_var <- cumsum(explained_var)

# Create table
pca_table <- data.frame(
  Component = paste0("PC", 1:length(explained_var)),
  Individual_Variance = sprintf("%.2f%%", explained_var*100),
  Cumulative_Variance = sprintf("%.2f%%", cumulative_var*100)
)

pca_table %>%
  kable(col.names = c("Component", "Individual Variance", "Cumulative Variance")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## 6.3. Required Components

```{r pca_components}
n_components_90 <- which(cumulative_var >= 0.90)[1]
cat(sprintf("Components needed for 90%% variance: %d\n", n_components_90))
cat(sprintf("Dimensionality reduction: %.2f%%\n", 
            (1 - n_components_90/length(pca_features))*100))
```

## 6.4. Explained Variance Visualization

```{r pca_variance_plot, fig.width=14, fig.height=6, fig.cap="PCA Explained Variance"}
par(mfrow=c(1,2))

# Scree plot
plot(1:length(explained_var), explained_var*100, 
     type="b", pch=19, col="blue", lwd=2,
     main="Scree Plot - Variance Explained by Component",
     xlab="Principal Component",
     ylab="Explained Variance (%)",
     cex.main=1.2, cex.lab=1.1)
grid()

# Cumulative variance
plot(1:length(cumulative_var), cumulative_var*100, 
     type="b", pch=19, col="red", lwd=2,
     main="Cumulative Explained Variance",
     xlab="Number of Components",
     ylab="Cumulative Explained Variance (%)",
     cex.main=1.2, cex.lab=1.1)
abline(h=90, col="blue", lty=2, lwd=2)
text(length(cumulative_var)*0.7, 92, "90% variance", col="blue")
grid()
```
# Cumulative variance

plot(1:length(cumulative_var), cumulative_var*100, 
     type="b", pch=19, col="red", lwd=2,
     main="Cumulative Explained Variance",
     xlab="Number of Components",
     ylab="Cumulative Explained Variance (%)",
     cex.main=1.2, cex.lab=1.1)
abline(h=90, col="blue", lty=2, lwd=2)
text(length(cumulative_var)*0.7, 92, "90% variance", col="blue")
grid()
```


# 7. Conclusion

## 7.1. Key Findings

This project identified the following risk factors for severe accidents:

1.  **Rural Areas** (+4.7% correlation)
    -   Accidents in rural areas have a 23.67% chance of being severe.
    -   Urban areas: only 17.43%.

2.  **High Speed Limits** (+4.1% correlation)
    -   Higher speeds significantly increase severity.

3.  **Poor Lighting Conditions** (+2.6% correlation)
    -   Darkness and poor lighting are risk factors.

4.  **Junction Type** (+3.3% correlation)
    -   Certain junction types pose a higher risk.

## 7.2. PCA Results

-   **Dimensionality reduction**: 9 → 7 components
-   **Variance retained**: 91.76%
-   **Information loss**: Only 8.24%

## 7.3. Public Policy Implications

Based on the findings, it is recommended to:

-   **Prioritize speed enforcement** in rural areas.
-   **Invest in road lighting** infrastructure.
-   **Redesign high-risk junctions**.
-   **Targeted educational campaigns** for rural drivers.
-   **Reinforce signage** in identified high-risk areas.

## 7.4. Study Limitations

-   Data limited to the year 2024.
-   UK-specific (not globally generalizable).
-   Behavioral variables not included (e.g., alcohol use, distraction).

## 7.5. Future Research

-   Temporal analysis (multiple years).
-   Predictive modeling of severity.
-   Integration with real-time traffic data.
-   Cost-benefit analysis of interventions.


# 8. References

1.  UK Department for Transport. (2024). *Road Safety Data*. Available at: https://www.data.gov.uk/
2.  R Core Team. (2024). *R: A Language and Environment for Statistical Computing*. R Foundation for Statistical Computing.
3.  Wickham, H. et al. (2019). *Welcome to the Tidyverse*. Journal of Open Source Software, 4(43), 1686.


# 9. System Information

```{r session_info}
sessionInfo()
```


**Author**: Tiago De Oliveira Freitas  
**Student Number**: 2021406  
**Institution**: CCT College Dublin  
**GitHub Repository**: https://github.com/TiagoStudent/CA1_DEP_TiagoDeOliveiraFreitas_2021406.git  
**Date**: November 30, 2025
